import{_ as s,c as a,o as i,a4 as e}from"./chunks/framework.nQaBHiNx.js";const y=JSON.parse('{"title":"","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"nestjs-deployment/deploy-to-server.md","filePath":"nestjs-deployment/deploy-to-server.md"}'),t={name:"nestjs-deployment/deploy-to-server.md"},n=e(`<p>Deploying to the Server</p><p>Now that your project is built, it‚Äôs time to deploy it to your virtual server (V-Server). This section explains how to manually transfer and run your app, as well as how to automate it later if desired.</p><h2 id="prepare-the-server" tabindex="-1">Prepare the Server <a class="header-anchor" href="#prepare-the-server" aria-label="Permalink to &quot;Prepare the Server&quot;">‚Äã</a></h2><p>Make sure your server:</p><ul><li>Has Node.js and npm installed (also make sure you have the correct version!)</li><li>Has a dedicated deployment directory (e.g., <code>/var/www/nest-app</code>)</li><li>Allows SSH access</li></ul><h3 id="create-a-directory" tabindex="-1">Create a directory <a class="header-anchor" href="#create-a-directory" aria-label="Permalink to &quot;Create a directory&quot;">‚Äã</a></h3><p>If this is the first time you are deploying your NestJS application, you most likely need to create a new directory. You can do it manually using it via an FTP client like WinSCP. Or you can use the following command:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/nest-app</span></span></code></pre></div><h2 id="transfer-files-to-server" tabindex="-1">Transfer files to Server <a class="header-anchor" href="#transfer-files-to-server" aria-label="Permalink to &quot;Transfer files to Server&quot;">‚Äã</a></h2><p>Now it is already the time to bring your files to the server. Here are three easy ways to copy your files to your server.</p><h3 id="winscp" tabindex="-1">WinSCP <a class="header-anchor" href="#winscp" aria-label="Permalink to &quot;WinSCP&quot;">‚Äã</a></h3><div class="info custom-block"><p class="custom-block-title">üîé Info</p><p>This is only available for Windows.</p></div><p>Connect to your server, and copy over the files in the previously created directory. You need the following files in your directory:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>- /dist</span></span>
<span class="line"><span>- package.json</span></span>
<span class="line"><span>- .env.production</span></span></code></pre></div><h3 id="using-scp" tabindex="-1">Using scp <a class="header-anchor" href="#using-scp" aria-label="Permalink to &quot;Using scp&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.production</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user@your-server-ip:/var/www/nest-app</span></span></code></pre></div><p>Replace <code>user@your-server-ip</code> with your actual server credentials.</p><h3 id="using-rsync" tabindex="-1">Using rsync <a class="header-anchor" href="#using-rsync" aria-label="Permalink to &quot;Using rsync&quot;">‚Äã</a></h3><div class="warning custom-block"><p class="custom-block-title">‚ö†Ô∏è Warning ‚ö†Ô∏è</p><p>This is recommended for updates.</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package.json</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.production</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user@your-server-ip:/var/www/nest-app</span></span></code></pre></div><p>Replace <code>user@your-server-ip</code> with your actual server credentials.</p><h2 id="install-dependencies" tabindex="-1">Install Dependencies <a class="header-anchor" href="#install-dependencies" aria-label="Permalink to &quot;Install Dependencies&quot;">‚Äã</a></h2><ol><li>Login to your server:</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user@your-server-ip</span></span></code></pre></div><ol start="2"><li>Navigate to the app directory</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/nest-app</span></span></code></pre></div><ol start="3"><li>Install only production dependencies</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --omit=dev</span></span></code></pre></div><h2 id="run-the-application" tabindex="-1">Run the Application <a class="header-anchor" href="#run-the-application" aria-label="Permalink to &quot;Run the Application&quot;">‚Äã</a></h2><p>To run your application, you can either start it manually, just as you already did when you tested it locally:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">production</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist/main.js</span></span></code></pre></div><p>But preferably you can use a process manager like PM2. With a tool like this you can also let the application restart automatically if the server restarts.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pm2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist/main.js</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nest-app</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --env</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> production</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> save</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> startup</span></span></code></pre></div>`,33),l=[n];function p(r,h,o,d,c,k){return i(),a("div",null,l)}const g=s(t,[["render",p]]);export{y as __pageData,g as default};
